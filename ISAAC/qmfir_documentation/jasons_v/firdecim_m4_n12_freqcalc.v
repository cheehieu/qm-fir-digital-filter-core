// ******************************************************************************* //
// **                    General Information                                    ** //
// ******************************************************************************* //
// **  Module             : firdecim_m4_n12_freqcalc.v                          ** //
// **  Project            : ISAAC Newton / SMAP                                 ** //
// **  Author             : Kayla Nguyen                                        ** //
// **  First Release Date : February 9, 2009                                    ** //
// **  Description        : Calculate coefficients when frequency tuning for    ** //
// **                       FIR0                                                ** //
// ******************************************************************************* //
// **                     Revision History                                      ** //
// ******************************************************************************* //
// **                                                                           ** //
// **  File        : FIR0_freqcalc.v                                            ** //
// **  Revision    : 1                                                          ** //
// **  Author      : kaylangu                                                   ** //
// **  Date        : February 9, 2009                                           ** //
// **  FileName    :                                                            ** //
// **  Notes       : Initial Release for SMAP demo                              ** //
// **                                                                           ** //
// **  File        : firdecim_m4_n12_freqcalc.v                                 ** //
// **  Revision    : 1                                                          ** //
// **  Author      : kaylangu                                                   ** //
// **  Date        : February 9, 2009                                           ** //
// **  FileName    :                                                            ** //
// **  Notes       : Initial Release for SMAP demo                              ** //
// **                                                                           ** //
// ******************************************************************************* //
`timescale 1ns/100ps

module firdecim_m4_n12_freqcalc(/*AUTOARG*/
   // Outputs
   er, ei, new_e,
   // Inputs
   clk, rst, freq, newFreq
   );
   
   //**************************************************************************//
   //*                       Declarations                                     *//
   //**************************************************************************//
   // DATA TYPE - PARAMETERS
   parameter h0 = 16'b1111_1111_1001_1001;     // Constants for multipliers
   parameter h1 = 16'b1111_1111_0111_1101;
   parameter h2 = 16'b0000_0001_0000_0100;
   parameter h3 = 16'b0000_0101_0100_0001;
   parameter h4 = 16'b0000_1011_0010_1001;
   parameter h5 = 16'b0000_1111_1001_0000;
   parameter h6 = 16'b0000_1111_1001_0000;
   parameter h7 = 16'b0000_1011_0010_1001;
   parameter h8 = 16'b0000_0101_0100_0001;
   parameter h9 = 16'b0000_0001_0000_0100;
   parameter hA = 16'b1111_1111_0111_1101;
   parameter hB = 16'b1111_1111_1001_1001;

   parameter OWIDTH = 16;
   parameter ACCUMWIDTH = 32;
   parameter NTAPS = 12;
   
   
   // DATA TYPE - INPUTS AND OUTPUTS
   input                            clk;
   input 			    rst;
   input [6:0] 			    freq;
   input 			    newFreq;
   output reg signed [(OWIDTH-1):0] er;
   output reg signed [(OWIDTH-1):0] ei;
   output 			    new_e;
   
   // DATA TYPE - WIRES
   wire signed [(ACCUMWIDTH-1):0]   er_t;
   wire signed [(ACCUMWIDTH-1):0]   ei_t;
   
   // DATA TYPE - REGISTERS
   reg [6:0] 			    freq_1d; // Store freq to end of calculation
   reg 				    FreqCalc;// Store newFreq to end of calculation
   reg [4:0] 			    lkupcnt; // Counter to count how many coefficients
   reg [7:0] 			    freqcnt; // Counter to go in to look-up table                                                             
   reg signed [15:0] 		    sine1;   // 2-bit integer + 14-bit fraction
   reg signed [15:0] 		    cosine1; // 2-bit integer + 14-bit fraction
   reg signed [15:0] 		    h;       // Final Mux outputs of h's
   reg 				    newFreq_1d;
   
   
   //**************************************************************************//
   //*                      Input Buffers                                     *//
   //**************************************************************************//
   always @ (posedge clk or posedge rst)
     if (rst)
       begin
          freq_1d[6:0] <= 7'd0;
          FreqCalc <= 1'b0;
       end
     else
       begin
          freq_1d[6:0] <= newFreq      ? 
                          freq[6:0]    :
                          freq_1d[6:0] ;
          FreqCalc <= FreqCalc ?
                      ~(lkupcnt[4:0] == (NTAPS + 3)) :
                      newFreq & ~newFreq_1d;
       end

   always @ (posedge clk or posedge rst)
     if (rst)
       begin
	  newFreq_1d <= 1'b0;
       end
     else
       begin
	  newFreq_1d <= newFreq;
       end

   
   //**************************************************************************//
   //*                         Counters                                       *//
   //**************************************************************************//
   always @ (posedge clk or posedge rst)
     if (rst)
       begin
          lkupcnt[4:0]    <= 5'd0;
       end
     else 
       begin
          lkupcnt[4:0]    <= lkupcnt[4:0] + (FreqCalc) ;
       end    
   
   always @ (posedge clk or posedge rst)
     if (rst)
       begin
          freqcnt[7:0] <= 8'd0;
       end
     else if (newFreq & ~newFreq_1d)
       begin
          freqcnt[7:0] <= 8'd0;
       end
     else if (FreqCalc)
       begin
          freqcnt[7:0] <= (freqcnt[7:0] + freq_1d[6:0]) > 239 ?
                          (freqcnt[7:0] + freq_1d[6:0] - 240) :
                          (freqcnt[7:0] + freq_1d[6:0]);
       end
      
   //**************************************************************************//
   //*                       Choosing h's                                     *//
   //**************************************************************************//
   always @ (posedge clk or posedge rst)
     if (rst)
       begin
          h[15:0] <= 16'd0;
       end
     else
       begin
          case (lkupcnt[3:0])
            4'b0000: h[15:0] <= h0[15:0];
            4'b0001: h[15:0] <= h1[15:0];
            4'b0010: h[15:0] <= h2[15:0];
            4'b0011: h[15:0] <= h3[15:0]; 
            4'b0100: h[15:0] <= h4[15:0];
            4'b0101: h[15:0] <= h5[15:0];
            4'b0110: h[15:0] <= h6[15:0];
            4'b0111: h[15:0] <= h7[15:0];
            4'b1000: h[15:0] <= h8[15:0];
            4'b1001: h[15:0] <= h9[15:0];
            4'b1010: h[15:0] <= hA[15:0];
            4'b1011: h[15:0] <= hB[15:0];
            default: h[15:0] <= h0[15:0];
          endcase 
       end

   //**************************************************************************//
   //*                       Multipliers                                      *//
   //**************************************************************************//
   always @ (posedge clk or posedge rst)
     if (rst)
       begin
          er[(OWIDTH-1):0] <= {(OWIDTH-1){1'b0}};
          ei[(OWIDTH-1):0] <= {(OWIDTH-1){1'b0}};
       end
     else
       begin
          er[(OWIDTH-1):0] <=  er_t[(ACCUMWIDTH-3):(ACCUMWIDTH-OWIDTH-2)];
          ei[(OWIDTH-1):0] <=  ei_t[(ACCUMWIDTH-3):(ACCUMWIDTH-OWIDTH-2)];
       end
   
   assign er_t[(ACCUMWIDTH-1):0] = h*cosine1;
   assign ei_t[(ACCUMWIDTH-1):0] = h*sine1;

   
   //**************************************************************************//
   //*                 Output Buffers/Shifter                                 *//
   //**************************************************************************//
   assign new_e = (lkupcnt[4:0] < 14  );
   
   
   //**************************************************************************//
   //*                          Submodules                                    *//
   //**************************************************************************//
   //Sine1
   always @ (posedge clk or posedge rst)
     if (rst)
       begin
          sine1 <= 16'd0;
       end 
     else
       begin
          case (freqcnt[7:0])
            8'b0000_0000: sine1 <= 16'b0000000000000000   ;
            8'b0000_0001: sine1 <= 16'b0000000110101100   ;
            8'b0000_0010: sine1 <= 16'b0000001101011001   ;
            8'b0000_0011: sine1 <= 16'b0000010100000101   ;
            8'b0000_0100: sine1 <= 16'b0000011010110000   ;
            8'b0000_0101: sine1 <= 16'b0000100001011010   ;
            8'b0000_0110: sine1 <= 16'b0000101000000011   ;
            8'b0000_0111: sine1 <= 16'b0000101110101001   ;
            8'b0000_1000: sine1 <= 16'b0000110101001110   ;
            8'b0000_1001: sine1 <= 16'b0000111011110000   ;
            8'b0000_1010: sine1 <= 16'b0001000010010000   ;
            8'b0000_1011: sine1 <= 16'b0001001000101101   ;
            8'b0000_1100: sine1 <= 16'b0001001111000110   ;
            8'b0000_1101: sine1 <= 16'b0001010101011101   ;
            8'b0000_1110: sine1 <= 16'b0001011011101111   ;
            8'b0000_1111: sine1 <= 16'b0001100001111101   ;
            8'b0001_0000: sine1 <= 16'b0001101000000111   ;
            8'b0001_0001: sine1 <= 16'b0001101110001101   ;
            8'b0001_0010: sine1 <= 16'b0001110100001110   ;
            8'b0001_0011: sine1 <= 16'b0001111010001001   ;
            8'b0001_0100: sine1 <= 16'b0001111111111111   ;
            8'b0001_0101: sine1 <= 16'b0010000101110000   ;
            8'b0001_0110: sine1 <= 16'b0010001011011011   ;
            8'b0001_0111: sine1 <= 16'b0010010000111111   ;
            8'b0001_1000: sine1 <= 16'b0010010110011110   ;
            8'b0001_1001: sine1 <= 16'b0010011011110101   ;
            8'b0001_1010: sine1 <= 16'b0010100001000110   ;
            8'b0001_1011: sine1 <= 16'b0010100110010000   ;
            8'b0001_1100: sine1 <= 16'b0010101011010011   ;
            8'b0001_1101: sine1 <= 16'b0010110000001110   ;
            8'b0001_1110: sine1 <= 16'b0010110101000001   ;
            8'b0001_1111: sine1 <= 16'b0010111001101100   ;
            8'b0010_0000: sine1 <= 16'b0010111110001111   ;
            8'b0010_0001: sine1 <= 16'b0011000010101010   ;
            8'b0010_0010: sine1 <= 16'b0011000110111100   ;
            8'b0010_0011: sine1 <= 16'b0011001011000110   ;
            8'b0010_0100: sine1 <= 16'b0011001111000110   ;
            8'b0010_0101: sine1 <= 16'b0011010010111110   ;
            8'b0010_0110: sine1 <= 16'b0011010110101100   ;
            8'b0010_0111: sine1 <= 16'b0011011010010001   ;
            8'b0010_1000: sine1 <= 16'b0011011101101100   ;
            8'b0010_1001: sine1 <= 16'b0011100000111110   ;
            8'b0010_1010: sine1 <= 16'b0011100100000110   ;
            8'b0010_1011: sine1 <= 16'b0011100111000011   ;
            8'b0010_1100: sine1 <= 16'b0011101001110111   ;
            8'b0010_1101: sine1 <= 16'b0011101100100000   ;
            8'b0010_1110: sine1 <= 16'b0011101110111111   ;
            8'b0010_1111: sine1 <= 16'b0011110001010100   ;
            8'b0011_0000: sine1 <= 16'b0011110011011110   ;
            8'b0011_0001: sine1 <= 16'b0011110101011101   ;
            8'b0011_0010: sine1 <= 16'b0011110111010001   ;
            8'b0011_0011: sine1 <= 16'b0011111000111011   ;
            8'b0011_0100: sine1 <= 16'b0011111010011001   ;
            8'b0011_0101: sine1 <= 16'b0011111011101101   ;
            8'b0011_0110: sine1 <= 16'b0011111100110110   ;
            8'b0011_0111: sine1 <= 16'b0011111101110011   ;
            8'b0011_1000: sine1 <= 16'b0011111110100110   ;
            8'b0011_1001: sine1 <= 16'b0011111111001101   ;
            8'b0011_1010: sine1 <= 16'b0011111111101001   ;
            8'b0011_1011: sine1 <= 16'b0011111111111010   ;
            8'b0011_1100: sine1 <= 16'b0100000000000000   ;
            8'b0011_1101: sine1 <= 16'b0011111111111010   ;
            8'b0011_1110: sine1 <= 16'b0011111111101001   ;
            8'b0011_1111: sine1 <= 16'b0011111111001101   ;
            8'b0100_0000: sine1 <= 16'b0011111110100110   ;
            8'b0100_0001: sine1 <= 16'b0011111101110011   ;
            8'b0100_0010: sine1 <= 16'b0011111100110110   ;
            8'b0100_0011: sine1 <= 16'b0011111011101101   ;
            8'b0100_0100: sine1 <= 16'b0011111010011001   ;
            8'b0100_0101: sine1 <= 16'b0011111000111011   ;
            8'b0100_0110: sine1 <= 16'b0011110111010001   ;
            8'b0100_0111: sine1 <= 16'b0011110101011101   ;
            8'b0100_1000: sine1 <= 16'b0011110011011110   ;
            8'b0100_1001: sine1 <= 16'b0011110001010100   ;
            8'b0100_1010: sine1 <= 16'b0011101110111111   ;
            8'b0100_1011: sine1 <= 16'b0011101100100000   ;
            8'b0100_1100: sine1 <= 16'b0011101001110111   ;
            8'b0100_1101: sine1 <= 16'b0011100111000011   ;
            8'b0100_1110: sine1 <= 16'b0011100100000110   ;
            8'b0100_1111: sine1 <= 16'b0011100000111110   ;
            8'b0101_0000: sine1 <= 16'b0011011101101100   ;
            8'b0101_0001: sine1 <= 16'b0011011010010001   ;
            8'b0101_0010: sine1 <= 16'b0011010110101100   ;
            8'b0101_0011: sine1 <= 16'b0011010010111110   ;
            8'b0101_0100: sine1 <= 16'b0011001111000110   ;
            8'b0101_0101: sine1 <= 16'b0011001011000110   ;
            8'b0101_0110: sine1 <= 16'b0011000110111100   ;
            8'b0101_0111: sine1 <= 16'b0011000010101010   ;
            8'b0101_1000: sine1 <= 16'b0010111110001111   ;
            8'b0101_1001: sine1 <= 16'b0010111001101100   ;
            8'b0101_1010: sine1 <= 16'b0010110101000001   ;
            8'b0101_1011: sine1 <= 16'b0010110000001110   ;
            8'b0101_1100: sine1 <= 16'b0010101011010011   ;
            8'b0101_1101: sine1 <= 16'b0010100110010000   ;
            8'b0101_1110: sine1 <= 16'b0010100001000110   ;
            8'b0101_1111: sine1 <= 16'b0010011011110101   ;
            8'b0110_0000: sine1 <= 16'b0010010110011110   ;
            8'b0110_0001: sine1 <= 16'b0010010000111111   ;
            8'b0110_0010: sine1 <= 16'b0010001011011011   ;
            8'b0110_0011: sine1 <= 16'b0010000101110000   ;
            8'b0110_0100: sine1 <= 16'b0001111111111111   ;
            8'b0110_0101: sine1 <= 16'b0001111010001001   ;
            8'b0110_0110: sine1 <= 16'b0001110100001110   ;
            8'b0110_0111: sine1 <= 16'b0001101110001101   ;
            8'b0110_1000: sine1 <= 16'b0001101000000111   ;
            8'b0110_1001: sine1 <= 16'b0001100001111101   ;
            8'b0110_1010: sine1 <= 16'b0001011011101111   ;
            8'b0110_1011: sine1 <= 16'b0001010101011101   ;
            8'b0110_1100: sine1 <= 16'b0001001111000110   ;
            8'b0110_1101: sine1 <= 16'b0001001000101101   ;
            8'b0110_1110: sine1 <= 16'b0001000010010000   ;
            8'b0110_1111: sine1 <= 16'b0000111011110000   ;
            8'b0111_0000: sine1 <= 16'b0000110101001110   ;
            8'b0111_0001: sine1 <= 16'b0000101110101001   ;
            8'b0111_0010: sine1 <= 16'b0000101000000011   ;
            8'b0111_0011: sine1 <= 16'b0000100001011010   ;
            8'b0111_0100: sine1 <= 16'b0000011010110000   ;
            8'b0111_0101: sine1 <= 16'b0000010100000101   ;
            8'b0111_0110: sine1 <= 16'b0000001101011001   ;
            8'b0111_0111: sine1 <= 16'b0000000110101100   ;
            8'b0111_1000: sine1 <= 16'b0000000000000000   ;
            8'b0111_1001: sine1 <= 16'b1111111001010100   ;
            8'b0111_1010: sine1 <= 16'b1111110010100111   ;
            8'b0111_1011: sine1 <= 16'b1111101011111011   ;
            8'b0111_1100: sine1 <= 16'b1111100101010000   ; 
            8'b0111_1101: sine1 <= 16'b1111011110100110   ;
            8'b0111_1110: sine1 <= 16'b1111010111111101   ;
            8'b0111_1111: sine1 <= 16'b1111010001010111   ;
            8'b1000_0000: sine1 <= 16'b1111001010110010   ;
            8'b1000_0001: sine1 <= 16'b1111000100010000   ;
            8'b1000_0010: sine1 <= 16'b1110111101110000   ;
            8'b1000_0011: sine1 <= 16'b1110110111010011   ;
            8'b1000_0100: sine1 <= 16'b1110110000111010   ;
            8'b1000_0101: sine1 <= 16'b1110101010100011   ;
            8'b1000_0110: sine1 <= 16'b1110100100010001   ;
            8'b1000_0111: sine1 <= 16'b1110011110000011   ;
            8'b1000_1000: sine1 <= 16'b1110010111111001   ;
            8'b1000_1001: sine1 <= 16'b1110010001110011   ;
            8'b1000_1010: sine1 <= 16'b1110001011110010   ;
            8'b1000_1011: sine1 <= 16'b1110000101110111   ;
            8'b1000_1100: sine1 <= 16'b1110000000000000   ;
            8'b1000_1101: sine1 <= 16'b1101111010010000   ;
            8'b1000_1110: sine1 <= 16'b1101110100100101   ;
            8'b1000_1111: sine1 <= 16'b1101101111000001   ;
            8'b1001_0000: sine1 <= 16'b1101101001100010   ;
            8'b1001_0001: sine1 <= 16'b1101100100001011   ;
            8'b1001_0010: sine1 <= 16'b1101011110111010   ;
            8'b1001_0011: sine1 <= 16'b1101011001110000   ;
            8'b1001_0100: sine1 <= 16'b1101010100101101   ;
            8'b1001_0101: sine1 <= 16'b1101001111110010   ;
            8'b1001_0110: sine1 <= 16'b1101001010111111   ;
            8'b1001_0111: sine1 <= 16'b1101000110010100   ;
            8'b1001_1000: sine1 <= 16'b1101000001110001   ;
            8'b1001_1001: sine1 <= 16'b1100111101010110   ;
            8'b1001_1010: sine1 <= 16'b1100111001000100   ;
            8'b1001_1011: sine1 <= 16'b1100110100111010   ;
            8'b1001_1100: sine1 <= 16'b1100110000111010   ;
            8'b1001_1101: sine1 <= 16'b1100101101000010   ;
            8'b1001_1110: sine1 <= 16'b1100101001010100   ;
            8'b1001_1111: sine1 <= 16'b1100100101101111   ;
            8'b1010_0000: sine1 <= 16'b1100100010010100   ;
            8'b1010_0001: sine1 <= 16'b1100011111000010   ;
            8'b1010_0010: sine1 <= 16'b1100011011111010   ;
            8'b1010_0011: sine1 <= 16'b1100011000111101   ;
            8'b1010_0100: sine1 <= 16'b1100010110001001   ;
            8'b1010_0101: sine1 <= 16'b1100010011100000   ;
            8'b1010_0110: sine1 <= 16'b1100010001000001   ;
            8'b1010_0111: sine1 <= 16'b1100001110101100   ;
            8'b1010_1000: sine1 <= 16'b1100001100100010   ;
            8'b1010_1001: sine1 <= 16'b1100001010100011   ;
            8'b1010_1010: sine1 <= 16'b1100001000101111   ;
            8'b1010_1011: sine1 <= 16'b1100000111000101   ;
            8'b1010_1100: sine1 <= 16'b1100000101100111   ;
            8'b1010_1101: sine1 <= 16'b1100000100010011   ;
            8'b1010_1110: sine1 <= 16'b1100000011001010   ;
            8'b1010_1111: sine1 <= 16'b1100000010001101   ;
            8'b1011_0000: sine1 <= 16'b1100000001011010   ;
            8'b1011_0001: sine1 <= 16'b1100000000110011   ;
            8'b1011_0010: sine1 <= 16'b1100000000010111   ;
            8'b1011_0011: sine1 <= 16'b1100000000000110   ;
            8'b1011_0100: sine1 <= 16'b1100000000000000   ;
            8'b1011_0101: sine1 <= 16'b1100000000000110   ;
            8'b1011_0110: sine1 <= 16'b1100000000010111   ;
            8'b1011_0111: sine1 <= 16'b1100000000110011   ;
            8'b1011_1000: sine1 <= 16'b1100000001011010   ;
            8'b1011_1001: sine1 <= 16'b1100000010001101   ;
            8'b1011_1010: sine1 <= 16'b1100000011001010   ;
            8'b1011_1011: sine1 <= 16'b1100000100010011   ;
            8'b1011_1100: sine1 <= 16'b1100000101100111   ;
            8'b1011_1101: sine1 <= 16'b1100000111000101   ;
            8'b1011_1110: sine1 <= 16'b1100001000101111   ;
            8'b1011_1111: sine1 <= 16'b1100001010100011   ;
            8'b1100_0000: sine1 <= 16'b1100001100100010   ;
            8'b1100_0001: sine1 <= 16'b1100001110101100   ;
            8'b1100_0010: sine1 <= 16'b1100010001000001   ;
            8'b1100_0011: sine1 <= 16'b1100010011100000   ;
            8'b1100_0100: sine1 <= 16'b1100010110001001   ;
            8'b1100_0101: sine1 <= 16'b1100011000111101   ;
            8'b1100_0110: sine1 <= 16'b1100011011111010   ;
            8'b1100_0111: sine1 <= 16'b1100011111000010   ;
            8'b1100_1000: sine1 <= 16'b1100100010010100   ;
            8'b1100_1001: sine1 <= 16'b1100100101101111   ;
            8'b1100_1010: sine1 <= 16'b1100101001010100   ;
            8'b1100_1011: sine1 <= 16'b1100101101000010   ;
            8'b1100_1100: sine1 <= 16'b1100110000111010   ;
            8'b1100_1101: sine1 <= 16'b1100110100111010   ;
            8'b1100_1110: sine1 <= 16'b1100111001000100   ;
            8'b1100_1111: sine1 <= 16'b1100111101010110   ;
            8'b1101_0000: sine1 <= 16'b1101000001110001   ;
            8'b1101_0001: sine1 <= 16'b1101000110010100   ;
            8'b1101_0010: sine1 <= 16'b1101001010111111   ;
            8'b1101_0011: sine1 <= 16'b1101001111110010   ;
            8'b1101_0100: sine1 <= 16'b1101010100101101   ;
            8'b1101_0101: sine1 <= 16'b1101011001110000   ;
            8'b1101_0110: sine1 <= 16'b1101011110111010   ;
            8'b1101_0111: sine1 <= 16'b1101100100001011   ;
            8'b1101_1000: sine1 <= 16'b1101101001100010   ;
            8'b1101_1001: sine1 <= 16'b1101101111000001   ;
            8'b1101_1010: sine1 <= 16'b1101110100100101   ;
            8'b1101_1011: sine1 <= 16'b1101111010010000   ;
            8'b1101_1100: sine1 <= 16'b1110000000000000   ;
            8'b1101_1101: sine1 <= 16'b1110000101110111   ;
            8'b1101_1110: sine1 <= 16'b1110001011110010   ;
            8'b1101_1111: sine1 <= 16'b1110010001110011   ;
            8'b1110_0000: sine1 <= 16'b1110010111111001   ;
            8'b1110_0001: sine1 <= 16'b1110011110000011   ;
            8'b1110_0010: sine1 <= 16'b1110100100010001   ;
            8'b1110_0011: sine1 <= 16'b1110101010100011   ;
            8'b1110_0100: sine1 <= 16'b1110110000111010   ;
            8'b1110_0101: sine1 <= 16'b1110110111010011   ;
            8'b1110_0110: sine1 <= 16'b1110111101110000   ;
            8'b1110_0111: sine1 <= 16'b1111000100010000   ;
            8'b1110_1000: sine1 <= 16'b1111001010110010   ;
            8'b1110_1001: sine1 <= 16'b1111010001010111   ;
            8'b1110_1010: sine1 <= 16'b1111010111111101   ;
            8'b1110_1011: sine1 <= 16'b1111011110100110   ;
            8'b1110_1100: sine1 <= 16'b1111100101010000   ;
            8'b1110_1101: sine1 <= 16'b1111101011111011   ;
            8'b1110_1110: sine1 <= 16'b1111110010100111   ;
            8'b1110_1111: sine1 <= 16'b1111111001010100   ;
            default: sine1 <= 16'b1111111001010100   ;
          endcase
       end
   
   //Cosine1
   always @ (posedge clk or posedge rst)
     if (rst)
       begin
          cosine1 <= 16'd0;
       end 
     else
       begin
          case (freqcnt[7:0])
            8'b0000_0000: cosine1 <= 16'b0100000000000000   ;
            8'b0000_0001: cosine1 <= 16'b0011111111111010   ;
            8'b0000_0010: cosine1 <= 16'b0011111111101001   ;
            8'b0000_0011: cosine1 <= 16'b0011111111001101   ;
            8'b0000_0100: cosine1 <= 16'b0011111110100110   ;
            8'b0000_0101: cosine1 <= 16'b0011111101110011   ;
            8'b0000_0110: cosine1 <= 16'b0011111100110110   ;
            8'b0000_0111: cosine1 <= 16'b0011111011101101   ;
            8'b0000_1000: cosine1 <= 16'b0011111010011001   ;
            8'b0000_1001: cosine1 <= 16'b0011111000111011   ;
            8'b0000_1010: cosine1 <= 16'b0011110111010001   ;
            8'b0000_1011: cosine1 <= 16'b0011110101011101   ;
            8'b0000_1100: cosine1 <= 16'b0011110011011110   ;
            8'b0000_1101: cosine1 <= 16'b0011110001010100   ;
            8'b0000_1110: cosine1 <= 16'b0011101110111111   ;
            8'b0000_1111: cosine1 <= 16'b0011101100100000   ;
            8'b0001_0000: cosine1 <= 16'b0011101001110111   ;
            8'b0001_0001: cosine1 <= 16'b0011100111000011   ;
            8'b0001_0010: cosine1 <= 16'b0011100100000110   ;
            8'b0001_0011: cosine1 <= 16'b0011100000111110   ;
            8'b0001_0100: cosine1 <= 16'b0011011101101100   ;
            8'b0001_0101: cosine1 <= 16'b0011011010010001   ;
            8'b0001_0110: cosine1 <= 16'b0011010110101100   ;
            8'b0001_0111: cosine1 <= 16'b0011010010111110   ;
            8'b0001_1000: cosine1 <= 16'b0011001111000110   ;
            8'b0001_1001: cosine1 <= 16'b0011001011000110   ;
            8'b0001_1010: cosine1 <= 16'b0011000110111100   ;
            8'b0001_1011: cosine1 <= 16'b0011000010101010   ;
            8'b0001_1100: cosine1 <= 16'b0010111110001111   ;
            8'b0001_1101: cosine1 <= 16'b0010111001101100   ;
            8'b0001_1110: cosine1 <= 16'b0010110101000001   ;
            8'b0001_1111: cosine1 <= 16'b0010110000001110   ;
            8'b0010_0000: cosine1 <= 16'b0010101011010011   ;
            8'b0010_0001: cosine1 <= 16'b0010100110010000   ;
            8'b0010_0010: cosine1 <= 16'b0010100001000110   ;
            8'b0010_0011: cosine1 <= 16'b0010011011110101   ;
            8'b0010_0100: cosine1 <= 16'b0010010110011110   ;
            8'b0010_0101: cosine1 <= 16'b0010010000111111   ;
            8'b0010_0110: cosine1 <= 16'b0010001011011011   ;
            8'b0010_0111: cosine1 <= 16'b0010000101110000   ;
            8'b0010_1000: cosine1 <= 16'b0010000000000000   ;
            8'b0010_1001: cosine1 <= 16'b0001111010001001   ;
            8'b0010_1010: cosine1 <= 16'b0001110100001110   ;
            8'b0010_1011: cosine1 <= 16'b0001101110001101   ;
            8'b0010_1100: cosine1 <= 16'b0001101000000111   ;
            8'b0010_1101: cosine1 <= 16'b0001100001111101   ;
            8'b0010_1110: cosine1 <= 16'b0001011011101111   ;
            8'b0010_1111: cosine1 <= 16'b0001010101011101   ;
            8'b0011_0000: cosine1 <= 16'b0001001111000110   ;
            8'b0011_0001: cosine1 <= 16'b0001001000101101   ;
            8'b0011_0010: cosine1 <= 16'b0001000010010000   ;
            8'b0011_0011: cosine1 <= 16'b0000111011110000   ;
            8'b0011_0100: cosine1 <= 16'b0000110101001110   ;
            8'b0011_0101: cosine1 <= 16'b0000101110101001   ;
            8'b0011_0110: cosine1 <= 16'b0000101000000011   ;
            8'b0011_0111: cosine1 <= 16'b0000100001011010   ;
            8'b0011_1000: cosine1 <= 16'b0000011010110000   ;
            8'b0011_1001: cosine1 <= 16'b0000010100000101   ;
            8'b0011_1010: cosine1 <= 16'b0000001101011001   ;
            8'b0011_1011: cosine1 <= 16'b0000000110101100   ;
            8'b0011_1100: cosine1 <= 16'b0000000000000000   ;
            8'b0011_1101: cosine1 <= 16'b1111111001010100   ;
            8'b0011_1110: cosine1 <= 16'b1111110010100111   ;
            8'b0011_1111: cosine1 <= 16'b1111101011111011   ;
            8'b0100_0000: cosine1 <= 16'b1111100101010000   ;
            8'b0100_0001: cosine1 <= 16'b1111011110100110   ;
            8'b0100_0010: cosine1 <= 16'b1111010111111101   ;
            8'b0100_0011: cosine1 <= 16'b1111010001010111   ;
            8'b0100_0100: cosine1 <= 16'b1111001010110010   ;
            8'b0100_0101: cosine1 <= 16'b1111000100010000   ;
            8'b0100_0110: cosine1 <= 16'b1110111101110000   ;
            8'b0100_0111: cosine1 <= 16'b1110110111010011   ;
            8'b0100_1000: cosine1 <= 16'b1110110000111010   ;
            8'b0100_1001: cosine1 <= 16'b1110101010100011   ;
            8'b0100_1010: cosine1 <= 16'b1110100100010001   ;
            8'b0100_1011: cosine1 <= 16'b1110011110000011   ;
            8'b0100_1100: cosine1 <= 16'b1110010111111001   ;
            8'b0100_1101: cosine1 <= 16'b1110010001110011   ;
            8'b0100_1110: cosine1 <= 16'b1110001011110010   ;
            8'b0100_1111: cosine1 <= 16'b1110000101110111   ;
            8'b0101_0000: cosine1 <= 16'b1110000000000001   ;
            8'b0101_0001: cosine1 <= 16'b1101111010010000   ;
            8'b0101_0010: cosine1 <= 16'b1101110100100101   ;
            8'b0101_0011: cosine1 <= 16'b1101101111000001   ;
            8'b0101_0100: cosine1 <= 16'b1101101001100010   ;
            8'b0101_0101: cosine1 <= 16'b1101100100001011   ;
            8'b0101_0110: cosine1 <= 16'b1101011110111010   ;
            8'b0101_0111: cosine1 <= 16'b1101011001110000   ;
            8'b0101_1000: cosine1 <= 16'b1101010100101101   ;
            8'b0101_1001: cosine1 <= 16'b1101001111110010   ;
            8'b0101_1010: cosine1 <= 16'b1101001010111111   ;
            8'b0101_1011: cosine1 <= 16'b1101000110010100   ;
            8'b0101_1100: cosine1 <= 16'b1101000001110001   ;
            8'b0101_1101: cosine1 <= 16'b1100111101010110   ;
            8'b0101_1110: cosine1 <= 16'b1100111001000100   ;
            8'b0101_1111: cosine1 <= 16'b1100110100111010   ;
            8'b0110_0000: cosine1 <= 16'b1100110000111010   ;
            8'b0110_0001: cosine1 <= 16'b1100101101000010   ;
            8'b0110_0010: cosine1 <= 16'b1100101001010100   ;
            8'b0110_0011: cosine1 <= 16'b1100100101101111   ;
            8'b0110_0100: cosine1 <= 16'b1100100010010100   ;
            8'b0110_0101: cosine1 <= 16'b1100011111000010   ;
            8'b0110_0110: cosine1 <= 16'b1100011011111010   ;
            8'b0110_0111: cosine1 <= 16'b1100011000111101   ;
            8'b0110_1000: cosine1 <= 16'b1100010110001001   ;
            8'b0110_1001: cosine1 <= 16'b1100010011100000   ;
            8'b0110_1010: cosine1 <= 16'b1100010001000001   ;
            8'b0110_1011: cosine1 <= 16'b1100001110101100   ;
            8'b0110_1100: cosine1 <= 16'b1100001100100010   ;
            8'b0110_1101: cosine1 <= 16'b1100001010100011   ;
            8'b0110_1110: cosine1 <= 16'b1100001000101111   ;
            8'b0110_1111: cosine1 <= 16'b1100000111000101   ;
            8'b0111_0000: cosine1 <= 16'b1100000101100111   ;
            8'b0111_0001: cosine1 <= 16'b1100000100010011   ;
            8'b0111_0010: cosine1 <= 16'b1100000011001010   ;
            8'b0111_0011: cosine1 <= 16'b1100000010001101   ;
            8'b0111_0100: cosine1 <= 16'b1100000001011010   ;
            8'b0111_0101: cosine1 <= 16'b1100000000110011   ;
            8'b0111_0110: cosine1 <= 16'b1100000000010111   ;
            8'b0111_0111: cosine1 <= 16'b1100000000000110   ;
            8'b0111_1000: cosine1 <= 16'b1100000000000000   ;
            8'b0111_1001: cosine1 <= 16'b1100000000000110   ;
            8'b0111_1010: cosine1 <= 16'b1100000000010111   ;
            8'b0111_1011: cosine1 <= 16'b1100000000110011   ;
            8'b0111_1100: cosine1 <= 16'b1100000001011010   ; 
            8'b0111_1101: cosine1 <= 16'b1100000010001101   ;
            8'b0111_1110: cosine1 <= 16'b1100000011001010   ;
            8'b0111_1111: cosine1 <= 16'b1100000100010011   ;
            8'b1000_0000: cosine1 <= 16'b1100000101100111   ;
            8'b1000_0001: cosine1 <= 16'b1100000111000101   ;
            8'b1000_0010: cosine1 <= 16'b1100001000101111   ;
            8'b1000_0011: cosine1 <= 16'b1100001010100011   ;
            8'b1000_0100: cosine1 <= 16'b1100001100100010   ;
            8'b1000_0101: cosine1 <= 16'b1100001110101100   ;
            8'b1000_0110: cosine1 <= 16'b1100010001000001   ;
            8'b1000_0111: cosine1 <= 16'b1100010011100000   ;
            8'b1000_1000: cosine1 <= 16'b1100010110001001   ;
            8'b1000_1001: cosine1 <= 16'b1100011000111101   ;
            8'b1000_1010: cosine1 <= 16'b1100011011111010   ;
            8'b1000_1011: cosine1 <= 16'b1100011111000010   ;
            8'b1000_1100: cosine1 <= 16'b1100100010010100   ;
            8'b1000_1101: cosine1 <= 16'b1100100101101111   ;
            8'b1000_1110: cosine1 <= 16'b1100101001010100   ;
            8'b1000_1111: cosine1 <= 16'b1100101101000010   ;
            8'b1001_0000: cosine1 <= 16'b1100110000111010   ;
            8'b1001_0001: cosine1 <= 16'b1100110100111010   ;
            8'b1001_0010: cosine1 <= 16'b1100111001000100   ;
            8'b1001_0011: cosine1 <= 16'b1100111101010110   ;
            8'b1001_0100: cosine1 <= 16'b1101000001110001   ;
            8'b1001_0101: cosine1 <= 16'b1101000110010100   ;
            8'b1001_0110: cosine1 <= 16'b1101001010111111   ;
            8'b1001_0111: cosine1 <= 16'b1101001111110010   ;
            8'b1001_1000: cosine1 <= 16'b1101010100101101   ;
            8'b1001_1001: cosine1 <= 16'b1101011001110000   ;
            8'b1001_1010: cosine1 <= 16'b1101011110111010   ;
            8'b1001_1011: cosine1 <= 16'b1101100100001011   ;
            8'b1001_1100: cosine1 <= 16'b1101101001100010   ;
            8'b1001_1101: cosine1 <= 16'b1101101111000001   ;
            8'b1001_1110: cosine1 <= 16'b1101110100100101   ;
            8'b1001_1111: cosine1 <= 16'b1101111010010000   ;
            8'b1010_0000: cosine1 <= 16'b1110000000000000   ;
            8'b1010_0001: cosine1 <= 16'b1110000101110111   ;
            8'b1010_0010: cosine1 <= 16'b1110001011110010   ;
            8'b1010_0011: cosine1 <= 16'b1110010001110011   ;
            8'b1010_0100: cosine1 <= 16'b1110010111111001   ;
            8'b1010_0101: cosine1 <= 16'b1110011110000011   ;
            8'b1010_0110: cosine1 <= 16'b1110100100010001   ;
            8'b1010_0111: cosine1 <= 16'b1110101010100011   ;
            8'b1010_1000: cosine1 <= 16'b1110110000111010   ;
            8'b1010_1001: cosine1 <= 16'b1110110111010011   ;
            8'b1010_1010: cosine1 <= 16'b1110111101110000   ;
            8'b1010_1011: cosine1 <= 16'b1111000100010000   ;
            8'b1010_1100: cosine1 <= 16'b1111001010110010   ;
            8'b1010_1101: cosine1 <= 16'b1111010001010111   ;
            8'b1010_1110: cosine1 <= 16'b1111010111111101   ;
            8'b1010_1111: cosine1 <= 16'b1111011110100110   ;
            8'b1011_0000: cosine1 <= 16'b1111100101010000   ;
            8'b1011_0001: cosine1 <= 16'b1111101011111011   ;
            8'b1011_0010: cosine1 <= 16'b1111110010100111   ;
            8'b1011_0011: cosine1 <= 16'b1111111001010100   ;
            8'b1011_0100: cosine1 <= 16'b0000000000000000   ;
            8'b1011_0101: cosine1 <= 16'b0000000110101100   ;
            8'b1011_0110: cosine1 <= 16'b0000001101011001   ;
            8'b1011_0111: cosine1 <= 16'b0000010100000101   ;
            8'b1011_1000: cosine1 <= 16'b0000011010110000   ;
            8'b1011_1001: cosine1 <= 16'b0000100001011010   ;
            8'b1011_1010: cosine1 <= 16'b0000101000000011   ;
            8'b1011_1011: cosine1 <= 16'b0000101110101001   ;
            8'b1011_1100: cosine1 <= 16'b0000110101001110   ;
            8'b1011_1101: cosine1 <= 16'b0000111011110000   ;
            8'b1011_1110: cosine1 <= 16'b0001000010010000   ;
            8'b1011_1111: cosine1 <= 16'b0001001000101101   ;
            8'b1100_0000: cosine1 <= 16'b0001001111000110   ;
            8'b1100_0001: cosine1 <= 16'b0001010101011101   ;
            8'b1100_0010: cosine1 <= 16'b0001011011101111   ;
            8'b1100_0011: cosine1 <= 16'b0001100001111101   ;
            8'b1100_0100: cosine1 <= 16'b0001101000000111   ;
            8'b1100_0101: cosine1 <= 16'b0001101110001101   ;
            8'b1100_0110: cosine1 <= 16'b0001110100001110   ;
            8'b1100_0111: cosine1 <= 16'b0001111010001001   ;
            8'b1100_1000: cosine1 <= 16'b0010000000000000   ;
            8'b1100_1001: cosine1 <= 16'b0010000101110000   ;
            8'b1100_1010: cosine1 <= 16'b0010001011011011   ;
            8'b1100_1011: cosine1 <= 16'b0010010000111111   ;
            8'b1100_1100: cosine1 <= 16'b0010010110011110   ;
            8'b1100_1101: cosine1 <= 16'b0010011011110101   ;
            8'b1100_1110: cosine1 <= 16'b0010100001000110   ;
            8'b1100_1111: cosine1 <= 16'b0010100110010000   ;
            8'b1101_0000: cosine1 <= 16'b0010101011010011   ;
            8'b1101_0001: cosine1 <= 16'b0010110000001110   ;
            8'b1101_0010: cosine1 <= 16'b0010110101000001   ;
            8'b1101_0011: cosine1 <= 16'b0010111001101100   ;
            8'b1101_0100: cosine1 <= 16'b0010111110001111   ;
            8'b1101_0101: cosine1 <= 16'b0011000010101010   ;
            8'b1101_0110: cosine1 <= 16'b0011000110111100   ;
            8'b1101_0111: cosine1 <= 16'b0011001011000110   ;
            8'b1101_1000: cosine1 <= 16'b0011001111000110   ;
            8'b1101_1001: cosine1 <= 16'b0011010010111110   ;
            8'b1101_1010: cosine1 <= 16'b0011010110101100   ;
            8'b1101_1011: cosine1 <= 16'b0011011010010001   ;
            8'b1101_1100: cosine1 <= 16'b0011011101101100   ;
            8'b1101_1101: cosine1 <= 16'b0011100000111110   ;
            8'b1101_1110: cosine1 <= 16'b0011100100000110   ;
            8'b1101_1111: cosine1 <= 16'b0011100111000011   ;
            8'b1110_0000: cosine1 <= 16'b0011101001110111   ;
            8'b1110_0001: cosine1 <= 16'b0011101100100000   ;
            8'b1110_0010: cosine1 <= 16'b0011101110111111   ;
            8'b1110_0011: cosine1 <= 16'b0011110001010100   ;
            8'b1110_0100: cosine1 <= 16'b0011110011011110   ;
            8'b1110_0101: cosine1 <= 16'b0011110101011101   ;
            8'b1110_0110: cosine1 <= 16'b0011110111010001   ;
            8'b1110_0111: cosine1 <= 16'b0011111000111011   ;
            8'b1110_1000: cosine1 <= 16'b0011111010011001   ;
            8'b1110_1001: cosine1 <= 16'b0011111011101101   ;
            8'b1110_1010: cosine1 <= 16'b0011111100110110   ;
            8'b1110_1011: cosine1 <= 16'b0011111101110011   ;
            8'b1110_1100: cosine1 <= 16'b0011111110100110   ;
            8'b1110_1101: cosine1 <= 16'b0011111111001101   ;
            8'b1110_1110: cosine1 <= 16'b0011111111101001   ;
            8'b1110_1111: cosine1 <= 16'b0011111111111010   ;
            default: cosine1 <= 16'b0011111111111010   ;
          endcase
       end   
   
   
endmodule // firdecim_m4_n12_freqcalc

